(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{147:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return s}));var r=n(2),a=n(9),o=(n(0),n(178)),i={id:"object-type-builders",title:"Object Type Builders",sidebar_label:"Object Type Builders"},l={id:"object-type-builders",title:"Object Type Builders",description:"Allow us to define how [Object Type fields](https://graphql.org/learn/schema/#object-types-and-fields) need to be generated",source:"@site/docs/object-type-builders.md",permalink:"/graphql-kimera/docs/object-type-builders",editUrl:"https://github.com/lola-tech/graphql-kimera/edit/master/website/docs/object-type-builders.md",sidebar_label:"Object Type Builders"},c=[{value:"How they work",id:"how-they-work",children:[{value:"Fields with arguments",id:"fields-with-arguments",children:[]},{value:"Fields with Object Types",id:"fields-with-object-types",children:[]}]}],b={rightToc:c};function s(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"Allow us to define how ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://graphql.org/learn/schema/#object-types-and-fields"}),"Object Type fields")," need to be generated"),Object(o.b)("h2",{id:"how-they-work"},"How they work"),Object(o.b)("p",null,"Lets assume part of our schema looks like this:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"type Persona {\n  id: ID!\n  name: String\n  heightInCM: Int\n  heightInIN: Int\n}\n")),Object(o.b)("p",null,"We could use the following ",Object(o.b)("inlineCode",{parentName:"p"},"Persona")," type builder to specify the data source for the ",Object(o.b)("inlineCode",{parentName:"p"},"name")," field:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"{\n  Persona: () => ({\n    name: casual.full_name,\n  });\n}\n")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Note")),Object(o.b)("p",{parentName:"blockquote"},"The omitted fields (",Object(o.b)("inlineCode",{parentName:"p"},"heightInCM")," and ",Object(o.b)("inlineCode",{parentName:"p"},"heightInIN"),") will be auto-generated using lower priority data sources.")),Object(o.b)("h3",{id:"fields-with-arguments"},"Fields with arguments"),Object(o.b)("p",null,"Looking at the example above, you've probably noticed that the value for the ",Object(o.b)("inlineCode",{parentName:"p"},"name")," field resolves to a static value. That's great"),Object(o.b)("p",null,"What if ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://graphql.org/learn/queries/#arguments"}),"we need the field to accept arguments"),"? Kimera's got us covered by allowing us to return field resolvers from Object Type builders fields:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-graphql"}),"type Citizen {\n  id: ID!\n  name: String\n  friends(lastName: String): [Persona]\n}\n")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"{\n  Citizen: () => ({\n    name: casual.full_name,\n    friends: getPersonas => (_, { lastName }) => {\n      return getPersonas().filter(persona =>\n        persona.name.includes(filters.lastName)\n      );\n    };\n  }),\n}\n")),Object(o.b)("p",null,Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.apollographql.com/docs/graphql-tools/resolvers.html#Resolver-map"}),"The resolver")," needs to be returned by a a resolver factory function. A generic description of that function looks like this:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{}),"getFieldData =>\n  function fieldResolver(obj, args, context, info) {\n    // use getFieldData() and args to return the result\n  };\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"getFieldData")," returns the generated data for the field. For the example above, ",Object(o.b)("inlineCode",{parentName:"li"},"getPersonas")," returns the list of generated ",Object(o.b)("inlineCode",{parentName:"li"},"Persona"),"s (look at the ",Object(o.b)("inlineCode",{parentName:"li"},"friends")," field type in the ",Object(o.b)("inlineCode",{parentName:"li"},"Citizen")," Object Type definition)."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"fieldResolver")," is the function that gets executed to get the response to query for that field. In the example above, querying for a ",Object(o.b)("inlineCode",{parentName:"li"},"Citizen"),"'s ",Object(o.b)("inlineCode",{parentName:"li"},"friends")," will execute this function with the ",Object(o.b)("inlineCode",{parentName:"li"},"lastName")," ",Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"https://graphql.org/learn/queries/#variables"}),"query variable")," passed as a prop in the ",Object(o.b)("inlineCode",{parentName:"li"},"args")," parameter of the resolver."),Object(o.b)("li",{parentName:"ul"},"the ",Object(o.b)("inlineCode",{parentName:"li"},"fieldResolver")," function needs to return a result compatible with the type of the field. In the example above, the result must be an an array of objects constructed from the type ",Object(o.b)("inlineCode",{parentName:"li"},"Persona"),".")),Object(o.b)("p",null,"The argument for the first function (the resolver factory) is the generated result of the field we're writing the resolver for. In our case, the argument for the resolver contains an array of persons (",Object(o.b)("inlineCode",{parentName:"p"},"[Persona]"),")."),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Note")),Object(o.b)("p",{parentName:"blockquote"},"See it in action in the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/graphql-kimera/docs/tutorial-mutations#modifying-fields-with-arguments"}),'"Mutations" section of the Tutorial'),".")),Object(o.b)("h3",{id:"fields-with-object-types"},"Fields with Object Types"),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Note")),Object(o.b)("p",{parentName:"blockquote"},"Object Type fields should generally be omitted, and managed in their own Object Type builders.")),Object(o.b)("p",null,"An exception to the rule above is when we want the field to depend on data generated in the current node. In that case, we have to option of describing with a field scenario."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-graphql"}),"type Order {\n  id: ID!\n  courses: [Course]\n}\n")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-javascript"}),"{\n  Order: () => {\n    const coursesCount = random(1, 2);\n    return {\n      courses: times(coursesCount, () => ({})),\n    };\n  };\n}\n")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"Note")),Object(o.b)("p",null,"When a field couldn't be found in neither the Scenario nor a Object Type Builder, Kimera looks for it in the next, lower priority data source: the Field Name Builders."))}s.isMDXComponent=!0},178:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var b=a.a.createContext({}),s=function(e){var t=a.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):l({},t,{},e)),n},p=function(e){var t=s(e.components);return a.a.createElement(b.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=Object(r.forwardRef)((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,b=c(e,["components","mdxType","originalType","parentName"]),p=s(n),d=r,m=p["".concat(i,".").concat(d)]||p[d]||u[d]||o;return n?a.a.createElement(m,l({ref:t},b,{components:n})):a.a.createElement(m,l({ref:t},b))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var b=2;b<o;b++)i[b]=n[b];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);